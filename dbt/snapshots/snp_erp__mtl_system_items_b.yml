snapshots:
  - name: snp_erp__mtl_system_items_b
    relation: source('bronze_erp', 'MTL_SYSTEM_ITEMS_B')
    config:
      target_schema: SILVER_ERP
      unique_key: INVENTORY_ITEM_ID
      strategy: timestamp
      updated_at: _FIVETRAN_SYNCED
      hard_deletes: new_record
      dbt_valid_to_current: "to_date('9999-12-31')"
    description: "SCD2 snapshot of MTL_SYSTEM_ITEMS_B â€” tracks all historical record versions"
    columns:
      - name: dbt_scd_id
        description: "dbt surrogate key"
      - name: INVENTORY_ITEM_ID
        description: "Business key"
      - name: dbt_valid_from
        description: "Timestamp this record version became active"
      - name: dbt_valid_to
        description: "Timestamp this version was superseded"
      - name: dbt_is_current
        description: "True if this is the current active version"
      - name: dbt_is_deleted
        description: "True if the source row was hard-deleted"